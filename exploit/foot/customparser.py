from pcapng import FileScanner
from pcapng.blocks import EnhancedPacket
import binascii

with open('footmacro.pcapng', 'rb') as fp:
    scanner = FileScanner(fp)
    for i, block in enumerate(scanner):
        if isinstance(block, EnhancedPacket):
            data = bytearray(block.packet_data)
            if len(data) > 27:
                direction = "IN " if (data[21] >> 4) % 0x0F else "OUT"
                if direction != "OUT":
                    continue
                if len(data[27:]) == 8:
                    # print(f"{binascii.hexlify(data[27:], ' ')} / {len(data[27:])}")
                    print(f"await device.sendReport(0, new Uint8Array([ {', '.join([f'0x{val}' for val in data[27:].hex(' ', 1).split()])} ])); await sleep(100);")